<ion-header>
  <ion-toolbar>
    <ion-buttons>
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>View Order</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content *ngIf="!loading">
  <div class="ion-padding">
    <h2 style="text-align: center; color: #2f2f2f">
      <ion-icon name="heart" style="color: #a7b974"></ion-icon>
      <span style="color: #a7b974"> Thank you </span>for your order!
    </h2>
  </div>

  <ion-list inset="true">
    <ion-item>
      <ion-label>Order Date</ion-label>
      <ion-label>
        <h2>{{ order.createdAt | date:"dd MMM hh:mm" }}</h2>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>Order Status</ion-label>
      <ion-label>
        <h2 *ngIf="order.order_status === 'OPEN'" style="color: orange">
          Open
        </h2>
        <h2 *ngIf="order.order_status === 'CLOSED'" style="color: green">
          Complete
        </h2>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>Order Total</ion-label>
      <ion-label>
        <h2>{{ order.order_total | currency:"GBP":true }}</h2>
      </ion-label>
    </ion-item>

    <ion-item>
      <ion-label>Order Number</ion-label>
      <ion-label>
        <h2>{{ order.uuid }}</h2>
      </ion-label>
    </ion-item>
  </ion-list>

  <ion-list inset="true">

    <ion-list-header>
      <ion-label>Items For Order</ion-label>
    </ion-list-header>


    <ion-item *ngFor="let orderLine of order.multiOrderLines">
      <ion-label>
        <h2>
          ({{ orderLine.drop?.itemCode }})
          {{ orderLine.quantity }} x 
          {{ orderLine.line_title }}
        </h2>
      </ion-label>
    </ion-item>
  </ion-list>

  <ion-list
    inset="true"
    *ngIf="order.deliveryMethod === 'LOCAL_DELIVERY' || order.deliveryMethod === 'NATIONAL_DELIVERY'"
  >
    <ion-list-header>
      <ion-label>Delivery Address</ion-label>
    </ion-list-header>

    <ion-item>
      <ion-label> {{ order.deliveryAddressLine1 }} </ion-label>
    </ion-item>

    <ion-item>
      <ion-label> {{ order.deliveryAddressLine2 }} </ion-label>
    </ion-item>

    <ion-item>
      <ion-label> {{ order.deliveryAddressCity }} </ion-label>
    </ion-item>

    <ion-item>
      <ion-label> {{ order.deliveryAddressPostcode }} </ion-label>
    </ion-item>

    <ion-item>
      <ion-label> {{ order.deliveryAddressCountry }} </ion-label>
    </ion-item>
  </ion-list>

  <div class="order-update-status-buttons ion-padding">
    <!-- <ion-button
      expand="block"
      color="danger"
      *ngIf="order.order_status === 'OPEN' && order.sellerUuid === currentUserUuid"
    >
      Cancel Order
    </ion-button> -->

    <ion-button
      expand="block"
      color="success"
      (click)="assignDriver()"
      *ngIf="order.order_status === 'OPEN'"
    >
      Assign Delivery
    </ion-button>

    <ion-button
    expand="block"
    color="success"
    (click)="startPacking()"
    *ngIf="order.order_status === 'ASSIGNED_TO_DRIVER'"
  >
    Start Packing
  </ion-button>

    <ion-button
    expand="block"
    color="danger"
    (click)="releaseOrderFromDriver()"
    *ngIf="order.order_status === 'ASSIGNED_TO_DRIVER'"
  >
    Release Delivery
  </ion-button>

    <!-- <ion-button
      expand="block"
      color="danger"
      (click)="updateOrderStatus('OPEN')"
    >
      Re-open order
    </ion-button> -->
  </div>
</ion-content>

<ng-template *ngIf="loading">
  <ion-content>
    <ion-spinner name="crescent"></ion-spinner>
  </ion-content>
</ng-template>
